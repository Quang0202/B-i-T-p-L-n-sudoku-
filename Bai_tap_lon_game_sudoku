#include <iostream>
#include <cstdlib>
#include <stdlib.h>
using namespace std;
int sudokuBoard[9][9]={5,3,0,0,7,0,0,0,0,
                       6,0,0,1,9,5,0,0,0,
                       0,9,8,0,0,0,0,6,0,
                       0,5,0,0,6,0,0,0,3,
                       4,0,0,8,0,3,0,0,1,
                       7,0,0,0,2,0,0,0,6,
                       0,6,0,0,0,0,2,8,0,
                       0,0,0,4,1,9,0,0,5,
                       0,0,0,0,8,0,0,7,9};
int arrchange[9][9];
void change(int sudokuBoard[][9]);
void writearr(int sudokuBoard[][9]);
void display(int sudokuBoard[][9]);
void interact();
void getOption(int sudokuBoard[][9]);
void editSquare(int sudokuBoard[][9]);
void instructions();
void testgame(int sudokuBoard[][9]);
int main()
{
    change(sudokuBoard);
   interact();
   getOption(sudokuBoard);
   return 0;
}
void change(int sudokuBoard[][9])
{
    for(int i=0;i<9;i++)
        for(int j=0;j<9;j++)
    {
        if(sudokuBoard[i][j]==0)
            arrchange[i][j]=0;
         else
         arrchange[i][j]=1;
    }
}
void display(int sudokuBoard[][9])
{
   char option;
   system("color 0A");
   cout << "   A B C   D E F   G H I" << endl;
   cout<<"  -----------------------"<<endl;
   for(int i=0;i<9;i++)
   {
       cout<<i+1<<"|"<<" ";
       for(int j=0;j<9;j++)
       {
           cout<<sudokuBoard[i][j]<<" ";
           if(((j+1)%3)==0)
            cout<<"|"<<" ";
       }
       cout<<endl;
       if((i+1)%3==0)
        cout<<"  -----------------------"<<endl;
   }

  editSquare(sudokuBoard);
}

void interact()
{
    system("color 0B");
   cout << "Options:\n"
        << "   ?  Show these instructions\n"
        << "   I  Instructions\n"
        << "   E  Edit one square\n"
        << "   Q  Save and Quit\n"
        << "\n";

   return;
}
void instructions()
{
    cout<<endl;
    cout<<"-Each column must contain all of the numbers 1 through 9 and no two numbers in the same column of a Sudoku puzzle can be the same."<<endl;
    cout<<"-Each row must contain all of the numbers 1 through 9 and no two numbers in the same row of a Sudoku puzzle can be the same."<<endl;
    getOption(sudokuBoard);
}
void getOption(int sudokuBoard[][9])
{
    // chọn tùy chọn
   char option;
   cout << "> ";
   cin >> option;

   if (option == 'e' || option == 'E')
      {
          system("cls");
          display(sudokuBoard);
      }
   else if (option == '?')
      interact();
   else if (option == 'i' || option == 'I')
      instructions();
   else if (option == 'q' || option == 'Q')
      writearr(sudokuBoard);
   else
     {
         cout << "ERROR: Invalid command"<<endl;

        getOption(sudokuBoard);
     }
}

void editSquare(int sudokuBoard[][9])
{
   char letter;
   int number;
   int value = 0;
   int i;
   cout << "What are the coordinates of the square: ";//tọa độ của hình vuông
   cin  >> letter >> number;
   letter = toupper(letter);
   if((letter<65||letter>73)||(number<0||number>9))
   {
       cout<<"Do you want to stop the game ? :";
       cin>>i;
       if(i==0)
        editSquare(sudokuBoard);
       else
       {
           testgame(sudokuBoard);
           return;
       }
   }
   if (sudokuBoard[letter - 65][number - 1] !=0)
   {
       if(arrchange[letter-65][number-1]!=0)
        {
            cout << "ERROR: Square \'" << letter << number << "\' is read-only\n"<<endl;
            editSquare(sudokuBoard);
        }
        else
             {
                cout << "What is the value at \'" << letter << number << "\': ";
                 cin>>value;
                 sudokuBoard[number - 1][letter - 65] = value;
                 system("cls");
                 display(sudokuBoard);
             }
   }
   else
   {
      cout << "What is the value at \'" << letter << number << "\': ";
      cin  >> value;
      if (value < 1 || value > 9)
      {
         cout << "ERROR: Value \'" << value << "\' in square \'" << letter << number << "\' is invalid\n";
         cout << "\n";
         editSquare(sudokuBoard);
      }

      cout <<endl;
      sudokuBoard[number-1][letter - 65] = value;
      system("cls");
      display(sudokuBoard);
   }

   return;
}
void writearr(int sudokuBoard[][9])
{
     cout << "   A B C   D E F   G H I" << endl;
   cout<<"  -----------------------"<<endl;
   for(int i=0;i<9;i++)
   {
       cout<<i+1<<"|"<<" ";
       for(int j=0;j<9;j++)
       {
           cout<<sudokuBoard[i][j]<<" ";
           if(((j+1)%3)==0)
            cout<<"|"<<" ";
       }
       cout<<endl;
       if((i+1)%3==0)
        cout<<"  -----------------------"<<endl;
   }
}
void testgame(int sudokuBoard[][9])
{
    int stepcl=0,stepro=0,steparr=0,sumcl=0,sumro=0;
    for(int i=0;i<9;i++)
    {
        for(int j=0;j<9;j++)
        {
        sumro+=sudokuBoard[i][j];
        sumcl+=sudokuBoard[j][i];
        }
        if(sumro!=45||sumcl!=45)
            {
                cout<<"Game over!!"<<endl;
                return;
            }
        else
            {
                sumro=0;sumcl=0;
                steparr++;
            }
    }
    if(steparr!=9)
        {
            cout<<"Game over!!"<<endl;
            return ;
        }
    cout<<"You win!!!"<<endl;
    return;
}
